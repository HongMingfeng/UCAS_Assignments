### 从因果回路图到流图（第9-18页）

**存量和流量的基本概念**
1. **存量（Stocks/Levels）**：存量是系统在任意时间点的累积变量，表示随时间积累的内容。可以在任意时刻测量。例如：浴缸中的水量、城市的人口。
   
2. **流量（Flows/Rates）**：流量表示一段时间内的活动或变化，是导致存量变化的直接因素。流量可以增加存量（流入量）或减少存量（流出量）。例如：水龙头的注水量、人口迁移率。
   
3. **数学关系**：
   - 存量是流量的积分，表示流量的累积。
   - 流量是存量的微分，表示存量变化的速率。

**存量和流量的关系**
- 存量的变化仅由流量引起，一个存量可以有多个流入量和流出量。
- 识别存量和流量时需考虑研究问题，通常通过“单位”和“快照”法辨别：
  - 存量的单位不包含时间维度，而流量的单位包含时间。
  - 存量可以通过快照测量，而流量反映的是变化率，无法通过快照直接测量。

**存量的重要性**
- 存量表征系统状态，为决策和行动提供基础。它带来系统的惯性和记忆，是系统延迟的来源，也是动态不均衡的主要因素。

**流图的构成与符号**
- 流图（Stock and Flow Diagram）通过图形化的方式表现存量与流量的关系：
  - **长方形**：表示存量。
  - **箭头**：表示流量方向。
  - **阀门**：控制流量大小。
  - **云团**：表示流量的来源或去向不再系统内进一步定义的部分。

**案例：库存管理系统**
- 库存管理示例中，将“库存”作为存量，入库和出库为流量。该示例展示了存量在流图中的作用及其对整个系统的影响。不同于因果回路图，流图中不需要指定因果关系的极性，仅表达变量之间的关联性。

**辅助变量和常量**
1. **辅助变量（Auxiliary Variable）**：存量和流量间的中间变量，用于表达系统中的信息传递和决策过程。例如：库存管理中用于计算订货量的库存差。
   
2. **常量（Constant）**：保持不变或变化微小的变量，如税率或年利率。流量也可以是常数。
   
3. **作用**：辅助变量和常量可以简化流量的公式表达，有助于提升公式的易读性、便于修改和进行灵敏度分析。

**练习示例**
- **存量、流量和辅助变量辨别**：
  - 流量：折旧、采购。
  - 存量：固定资产、员工士气。
  - 辅助变量：价格。
  - 常数：税率、年利率。

**绘制流图的原则和技巧**
1. **每个反馈回路至少包含一个存量**：无存量的系统缺乏积累信息，无法分析系统动态。
   
2. **只有流量可以改变存量**：其他变量不能直接影响存量，需通过流量传递影响。
   
3. **存量通常影响流量**：存量为流量的决策提供信息，影响流量变化。
   
4. **技巧**：根据研究目的确定最少的存量，找出主要流量，其余变量则归为辅助变量或常量。

### 练习：记单词系统的因果回路图与流图构建（第19-22页）

**因果回路图构建**
- 在构建“记单词”系统的因果回路图时，需要识别关键回路和存量：
  1. **回路分析**：分析该系统中有哪些反馈回路。例如，记忆新单词的速度、遗忘比例和复习的时间可以形成多个因果回路。
  2. **主要存量**：在此系统中，“记住的单词数量”是关键存量，因为它反映了学习进展和知识积累的状态。
  3. **影响存量的流量**：存量的变化主要受到“新单词记忆速度”和“遗忘单词速度”的影响，这两个流量决定了系统内单词积累和流失的动态过程。

**流图构建**
- 根据因果回路图，进一步将该系统转化为流图。流图的核心在于明确存量、流量、辅助变量和可能的常量：
  1. **存量**：在流图中，“记住的单词”是核心存量，用长方形框表示。
  2. **流量**：
     - **记忆新单词流量**：表示新单词的记忆速度，是增加存量的流入量。
     - **遗忘单词流量**：表示遗忘的速度，是减少存量的流出量。
  3. **辅助变量**：例如“遗忘比例”和“复习时间”作为辅助变量，用于描述记忆和遗忘的过程影响。
  4. **常量**：如果有固定不变的变量，例如复习固定的速度等，可在模型中设为常量。

**箭头和变量关系**
- 在流图中，每个箭头代表一个变量关系，箭头指向表示流量的影响方向。箭头与存量和流量之间的关系建立后，需要进一步明确这些关系的性质。例如，“记住的单词数量”与“遗忘单词速度”之间可能是负相关关系，而与“复习时间”是正相关。

通过这个练习，可以理解如何从因果回路图转化为流图，并识别不同类型的变量及其相互关系。这一过程不仅有助于系统化表达动态变化，也为后续模型分析打下基础。

### Vensim中的赋值和函数（第24-43页）

**Vensim中的赋值步骤**
1. **存量的赋值**：
   - 存量的赋值通常包含“流入量 - 流出量”的结构。例如，某个存量可以通过入库和出库进行增减。
   - 初始值需要手动指定或由其他变量决定，单位不应包含时间维度。

2. **流量的赋值**：
   - 流量赋值通常使用“Functions”或“Variables”设置公式。
   - 单位必须包含时间维度（如“/day”），以反映其变化率。

3. **常量的赋值**：
   - 常量通常设为固定数值、外部数据或测试函数，例如税率或折旧率。
   - 选择“Constant”类型以确保其不随时间变化。

4. **引入外部数据（如Excel文件）**：
   - 选择“Data Only”函数，在公式中使用 `GET XLS DATA` 函数导入外部数据。参数包括文件名、表名和数据位置。

**Vensim中的主要函数类型**
1. **简单函数（Simple Functions）**：当前输入变量值决定函数输出，适用于数学计算和逻辑表达，例如：
   - `SIN(x)`：正弦函数
   - `EXP(x)`：指数函数
   - `LN(x)`：对数函数
   - `ABS(x)`：绝对值

2. **动态函数（Dynamic Functions）**：当前及过去的输入值决定函数输出，适用于系统动态分析，例如：
   - 积分函数、平滑函数和延迟函数。

3. **离散/延迟函数（Discrete/Delay Functions）**：用于离散事件追踪和队列处理。

4. **表函数（Lookup Functions）**：自变量与因变量之间的非线性关系，用于通过历史数据定义自变量的取值范围和变化模式。

5. **真实性检验函数（Reality Check Functions）**：确保模型结果符合实际情况，进行验证。

**常用的简单测试函数**
1. **阶梯函数（Step Function）**：模拟瞬间的变化，影响持续一段时间。
   - 格式：`STEP(height, stime)`，例如 `100 + STEP(100, 10)` 在第10时刻增加100。
   
2. **斜坡函数（Ramp Function）**：模拟缓慢持续的变化。
   - 格式：`RAMP(slope, start, finish)`，例如 `100 + RAMP(1, 10, 25)` 表示从10时刻开始逐渐增加。

3. **单脉冲函数（Pulse Function）**：模拟瞬间变化，效果瞬间消失。
   - 格式：`PULSE(start, duration)`，例如 `PULSE(10, 3)` 在第10时刻发生变化，持续3个时间单位。

4. **多脉冲函数（Pulse Train Function）**：模拟周期性变化。
   - 格式：`PULSE TRAIN(start, duration, repeat time, end)`。

5. **随机函数（Random Functions）**：引入不确定性，模拟随机因素影响。
   - `RANDOM UNIFORM(min, max, seed)`：均匀分布的随机数。
   - `RANDOM NORMAL(min, max, mean, stdev, seed)`：正态分布的随机数。

6. **逻辑函数（Logic Functions）**：
   - `MAX(P, Q)`：取两个数的最大值。
   - `MIN(P, Q)`：取两个数的最小值。
   - `IF THEN ELSE(condition, true, false)`：条件判断。

**表函数的应用**
- **表函数**用于表示非线性关系，通常通过历史数据定义自变量（X轴）和因变量（Y轴）范围：
   - 确定曲线的平缓或急剧变化部分，定义正、负反馈区间。
   - 当自变量为“时间”时，需加入“Time”的Shadow Variable，指向表函数。
   - 表函数支持 `WITH LOOKUP(X)` 语法，通过离散化的方式实现曲线近似。
  
**常见问题与解决**
- 在设置表函数时，若遇到“below or above”超出区间警告，可以通过调整X或Y轴的区间，或将值归一化来解决。

### Vensim中的模型运行与分析（第45-57页）

**模型设置**
1. **时间范围设置**：
   - 选择“Model -> Settings...”来设定模型的时间范围。参数包括：
     - **初始时间**（Initial Time）：模型开始的时间点。
     - **结束时间**（Final Time）：模型结束的时间点。
     - **仿真步长**（Time Step）：每次模拟的时间增量，控制仿真精度。
     - **时间单位**：每个步长单位的时间长度。
   - **积分算法**：默认使用Euler算法，该方法速度快，但精度不如Runge-Kutta法（推荐使用RK4 Auto）。

**模型运行**
1. **检查模型**：在运行之前，点击“Check Model”以确保所有变量均已赋值，防止出现未赋值变量导致的错误。
2. **运行模型**：在“Runname Box”中输入名称，点击“Simulate”进行仿真，生成的 `.vdf` 文件将保存此次运行的结果。
3. **灵敏度分析**：
   - 通过修改系统参数或条件来评估系统输出对参数变化的敏感度。
   - 在灵敏度分析时，注意更改“Runname Box”中的名称，以免覆盖原始数据。

**练习示例：记忆新单词时间**
- 将“记忆新单词时间”从60分钟逐渐降低至20分钟，分别设置多个不同时间段进行仿真运行，例如：
   - 第一次：60分钟
   - 第二次：50分钟
   - 依次递减至20分钟
- 使用多种分析工具（如因果变量图、时间表、对比图）观察变量变化。

**SyntheSim功能**
1. **实时观察曲线变化**：点击“Simulate”右侧的“SyntheSim”图标，进入实时仿真界面。
   - **滑块控制**：拖动滑块可以观察变量数值变化带来的曲线调整。
   - **临时数值修改**：在曲线上悬停并点击，可以临时更改变量数值，实时观察其影响。
2. **建立新视图（View）**：
   - 点击“View -> New”创建新的空白视图（例如“View 2”），用于对模型进一步分析或调整参数。
   - 在“Control Panel”中选择Graphs -> New创建新图表，可以直观展示流量或存量的变化对比。

**定制图表与输入输出控制**
1. **流量变化对比**：在“View 2”中创建流量变化对比图。例如，可以选择“背单词”和“遗忘单词”进行对比观察。
2. **编辑View 2**：
   - 在View中添加输入（Input），如滑块，以便动态调整变量。
   - 添加输出（Output），选择Workbench Tool或Custom Graph，可以以图表或表格形式展示数据。
3. **灵敏度分析**：
   - 比较不同变量值对系统输出的影响。例如，将“记忆速度”变量从3分钟增至4分钟，观察对“记单词效率”的影响。

**模板创建**
- **创建模板视图**：在View 3中建立模板，并重命名为“MyTemplate”，然后在视图的左上角使用Comment工具添加注释。
- 选择“View -> Template View”将其保存为模板。此模板将出现在其他视图（如View 1和View 2）中，实现统一的格式和说明信息。